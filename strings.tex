\section{Strings}

\subsection{KMP}
\begin{verbatim}
int* compute_prefix(string p) {
    int m=p.length();
    int *pi=(int*)malloc(sizeof(int)*m);
    pi[0]=0;
    int k=0;
    for(int q=1;q<m;q++) {
        while(k>0&&p[k]!=p[q])
            k=pi[k-1];
        if(p[k]==p[q])
            k++;
        pi[q]=k;
    }
    return pi;
}

void kmp_match(string s,string p) {
    int *pi=compute_prefix(p);
    int q=0;
    int n=s.length();
    int m=p.length();

    for(int i=0;i<n;i++) {
        while(q>0&&p[q]!=s[i])
            q=pi[q-1];
        if(p[q]==s[i])
            q++;
        if(q==m) {
            printf("Match pos %d\n",i-m+1);
        }
    }
}
\end{verbatim}

\subsection{Range Minimum Query}
\begin{verbatim}
int main() {
   int N,Q,i,j,k;

   scanf("%d %d",&N,&Q);

   for (i=0;i<N;i++)
	    scanf("%d",&n[i]);

   for (i=0;i<N;i++)
	    m[i][0]=M[i][0]=n[i];

   for (i=1;(1<<i)<=N;i++) {
	    for (j=0;j+(1<<i)-1<N;j++) {
	       m[j][i]=min(m[j][i-1],m[j+(1<<(i-1))][i-1]);
	       M[j][i]=max(M[j][i-1],M[j+(1<<(i-1))][i-1]);
	    }
   }

   for (k=0;k<Q;k++) {
	    scanf("%d %d",&i,&j);
	    i--;j--;
	    int t,p;
	    t=(int)(log(j-i+1)/log(2));
	    p=1<<t;
	    printf("%d\n",max(M[i][t],M[j-p+1][t])
	    - min(m[i][t], m[j - p + 1][t]));
   }
   return 0;
}
\end{verbatim}
$$
M[i][j]=\max(M[i][j-1],M[i+2^{j-1}][j-1])
$$
$$
RMQ_A(i,j)=\max(M[i][k],M[j-2^k+1][k])
$$

\subsection{Nth Permutation}
\begin{verbatim}
/*
 * calcula a k-esima permutacao de s
 * k = 0,1,2...
 * ATENCAO: esta funcao ignora o 1º caracter
 */
string permutation(long long int k, string s){
   int n = s.size()-1, factorial=1;
   for (int j = 2;j <= n - 1; j++)
	    factorial *= j;
   for (int j = 1;j <= n - 1; j++) {
	    int tempj = (k / factorial) % (n + 1 - j);
	    int temps = s[j + tempj];
	    for( int i = j + tempj; i >= j + 1; i--)
	       s[i] = s[i - 1];
	    s[j] = temps;
	    factorial = factorial / (n - j);
   }
   return s;
}
\end{verbatim}
